---
title: "Communicate"
date: "Semester 1, 2022"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    code_download: true
    code_folding: show
---


```{r setup, include=FALSE}
library(knitr)

knitr::opts_chunk$set(
  comment = "#>",
  fig.path = "figures/06/", # use only for single Rmd files
  collapse = TRUE,
  echo = TRUE
)


```


> #### Associated Material
>
> Zoom notes: [Zoom Notes 06 - Communicate](zoom_notes_06.html)
>
> Readings:
>
> - [R for Data Science - Chapter 27](https://r4ds.had.co.nz/r-markdown.html)
> - [R for Data Science - Chapter 29](https://r4ds.had.co.nz/r-markdown-formats.html)
> - [Reference: RMarkdown - the definitive guide](https://bookdown.org/yihui/rmarkdown/)


<!--
This module is going to cover: 

- using the {here} package to manage paths for scripts and rmarkdown

- Using the document outline/collapsing code in Rscripts
- (briefly) converting a R script into a notebook

The main focus will be on covering the usefulness of Rmarkdown in creating descriptive analysis documents

Cover the basics of the 3 components of an Rmarkdown document
- yaml
- markdown
- code chunks

Introduce the basic syntax of Markdown
- headers
- bold/italics
- lists
- verbatim code


Options of a code chunk
- echo
- eval
- include
- warning
- message
- fig
- results
- inline code

Embedding images
- images
  - knitr::include_graphics
  - `![]()`
  
Embedding plots


Making tables
- markdown
- knitr::kable
  - customising tables with the {kableExtra} package

-----
-->

## Introducing RMarkdown

So far through this course we've been using Rscripts for analysis which let us save and run our R code and include comments to let us know what we're doing along the way. We're now going to introduce RMarkdown documents - which are like Rscripts on steroids!

RMarkdown is a framework that enables the creation of reproducible documents which are a combination of text, R code, and the evaluated output from the code all embedded in a single document. Not only that, but from a single RMarkdown source document, multiple different output formats can be produced such as html, pdf, and Word doc.

Below is an example of an RMarkdown source document

```{r echo = FALSE, comment = ""}
cat(htmltools::includeText("scripts/gapminder_analysis.Rmd"))
```


There are three main components to this document

1. The **YAML** header which is surrounded by `---`s and provides information for the compiling process
2. R code **chunks** which are surrounded by ```` ``` ````s
3. Text which can be formatted using the Markdown language.

\

### Example RMarkdown

Before we delve into explaining each part of the RMarkdown file we're going to create our own from the included template that comes with RStudio.

Lets create our own RMarkdown document now from the template. To do this go `File` -> `New File` -> `R Markdown`. You'll then be presented with a window that looks like this

```{r, out.width="100%", echo = FALSE}
include_graphics("images/06-new_rmd.png")
```

Take the opportunity to fill in your name and title then click `OK`.

You should now have a document that looks like the following:

```{r echo = FALSE, comment = ""}
cat(htmltools::includeText("scripts/rmd_template.Rmd"))
```

\

### Knitting

In order to get our output document, we need to do a compiling step or **knit** the document - behind the scenes the text portions are formatted based on the markdown syntax, the R code is run and the results generated, and then the formatted text, code, and results are "**knitted**" together as a single output.

One of the key benefits on a reproducibility side is that RMarkdown is evaluated from top to bottom externally from your session and so it needs to be self-reliant and have all the commands from reading your data in, processing it, and making your awesome tables and plots like in the [Visualisation Module](02-visualise.html).

To knit the document look for the `knit` button in the top left of the "source" panel. The keyboard shortcut is <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>K</kbd> on PC or <kbd>Apple</kbd> + <kbd>Shift</kbd> + <kbd>K</kbd> on MacOS.

```{r, out.width = "100%", echo = FALSE}
include_graphics("images/01-markdown_knit_button.png")
```
You will then be prompted to save this script, call it "r_markdown_example.Rmd" as save it in your `scripts/` directory within your project directory. Once you have knitted a window should pop-up containing your brand new analysis document!

Take a few minutes to read from top to bottom through your script and identifying the same features in your outputted HTML document.

\

## Markdown syntax

- headers
- bold/italics
- lists
- verbatim code

## Code Chunks

- working directory
  - use of {here} package

### Code Chunk Options

- echo
- eval
- include
- warning
- message
- fig
- results
- inline code

## Figures and Tables

### Images

- \![alt text](url)
- knitr::include_graphics()

### Tables

- markdown tables
- creating tables with kable
- modifying kable tables with kableExtra

-----

The below content is copy/pasted from appendix of module 1





## Some more R Markdown

Let's look more closely at how you can use R Markdown to generate well-formatted research reports.

1\. Following the procedure described in Handout 2 - Get Started with R, create an R Markdown file

2\. The new file contains some template text. In the *second shaded block* replace the command `summary(cars)` with some of the code you have just written. Be careful not to delete either of the lines that begin with ```. Those symbols signal to RStudio that the contents is R code, not text. 

For example, I made this replacement:

```{r, fig.align='center', out.width = "50%", fig.cap = "Replace the template code with yours", fig.pos = "H", echo = FALSE, eval=FALSE}
include_graphics("images/markdown_replace_code.png")
```

3\. You might also want to replace some of the text (in the non-shaded areas), to match your new code. 

4\. Knit the document (click the Knit button). Wait while R processes the document. It will generate output to the console, but you can ignore that for now.

5\. Admire the result.

## Exercise - R Markdown

1. Figure out how to generate a Word document with R Markdown (Hint: look at the dropdown list beside the Knit button, by clicking the small triangle).
2. Some lines in the text areas of the R Markdown template start with ##, and the text is coloured Blue. What does the ## do? What do you think prefacing a line of text with ### would do? Test your theory.
